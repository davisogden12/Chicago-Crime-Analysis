data=read.csv('CrimesChicago20220225.csv')
View(data)
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
mutate(Category=case_when(str_detect(DESCRIPTION,violent)~'VIOLENT',
str_detect(DESCRIPTION,theft)~'THEFT',
str_detect(DESCRIPTION,narcotic)~'DRUG',
.default = 'OTHER' ))%>%
filter(str_detect(CATEGORY,'VIOLENT|THEFT|DRUG'))
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
rename_with(data, .fn=function(x){str_to_title(x)})
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
rename_with(.fn=function(x){str_to_title(x)})
mutate(Category=case_when(str_detect(Description,violent)~'VIOLENT',
str_detect(Description,theft)~'THEFT',
str_detect(Description,narcotic)~'DRUG',
.default = 'OTHER' ))%>%
filter(str_detect(Category,'VIOLENT|THEFT|DRUG'))
View(data)
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
rename_with(.fn=function(x){str_to_title(x)})%>%
mutate(Category=case_when(str_detect(Description,violent)~'VIOLENT',
str_detect(Description,theft)~'THEFT',
str_detect(Description,narcotic)~'DRUG',
.default = 'OTHER' ))%>%
filter(str_detect(Category,'VIOLENT|THEFT|DRUG'))
head(data)
#hourly crime distribution by category of crime
data%>%
group_by(Category,Hour)%>%
ggplot(aes(x=Hour,fill=Category))+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
stat_count()+
theme_grey()
data_sf=st_as_sf(data,
coords = c('Longitude','Latitude'),
crs = 'EPSG:4326')
data_sf=data_sf%>%
filter(!is.na(geometry))
shp=list.files(pattern = '.shp')
comm_boundary=st_read(shp)
comm_boundary=comm_boundary%>%
mutate(num_violent=sum(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'))))
st_crs(comm_boundary)
comm_boundary=st_read(shp,
crs='EPSG:4326')
comm_boundary=comm_boundary%>%
mutate(num_violent=sum(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'))))
comm_boundary=comm_boundary%>%
mutate(violent=sum(unlist(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))))
View(comm_boundary)
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
View(comm_boundary)
c
comm_boundary=comm_boundary%>%
mutate(violent=length(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'))))
View(comm_boundary)
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
View(comm_boundary)
comm_boundary=as.tibble(comm_boundary)%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
comm_boundary=tibble(comm_boundary)%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
View(comm_boundary)
comm_boundary$violent
comm_boundary=tibble(comm_boundary)%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE))
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE))
comm_boundary=st_read(shp,
crs='EPSG:4326')
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE))
View(comm_boundary)
comm_boundary=comm_boundary%>%
mutate(violent=sum(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE)))
View(comm_boundary)
View(comm_boundary[[10]][[1]])
View(comm_boundary[[10]][[2]])
sum(st_intersects(comm_boundary,data_sf$geometry))
sum(st_intersects(comm_boundary,data_sf$geometry),sparse=FALSE)
