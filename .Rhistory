data=read.csv('CrimesChicago20220225.csv')
View(data)
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
mutate(Category=case_when(str_detect(DESCRIPTION,violent)~'VIOLENT',
str_detect(DESCRIPTION,theft)~'THEFT',
str_detect(DESCRIPTION,narcotic)~'DRUG',
.default = 'OTHER' ))%>%
filter(str_detect(CATEGORY,'VIOLENT|THEFT|DRUG'))
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
rename_with(data, .fn=function(x){str_to_title(x)})
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
rename_with(.fn=function(x){str_to_title(x)})
mutate(Category=case_when(str_detect(Description,violent)~'VIOLENT',
str_detect(Description,theft)~'THEFT',
str_detect(Description,narcotic)~'DRUG',
.default = 'OTHER' ))%>%
filter(str_detect(Category,'VIOLENT|THEFT|DRUG'))
View(data)
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
mutate(DAY=wday(DATE,label=TRUE)) %>%
mutate(MONTH=month(DATE,label=TRUE))%>%
mutate(HOUR=hour(DATE))
ggplot(data = data, aes(x=HOUR))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data=data%>%
rename_with(.fn=function(x){str_to_title(x)})%>%
mutate(Category=case_when(str_detect(Description,violent)~'VIOLENT',
str_detect(Description,theft)~'THEFT',
str_detect(Description,narcotic)~'DRUG',
.default = 'OTHER' ))%>%
filter(str_detect(Category,'VIOLENT|THEFT|DRUG'))
head(data)
#hourly crime distribution by category of crime
data%>%
group_by(Category,Hour)%>%
ggplot(aes(x=Hour,fill=Category))+
labs(title = 'Chicago Crime',
subtitle='Hourly Crime Distribution')+
xlab('Hour')+
ylab('Frequency')+
stat_count()+
theme_grey()
data_sf=st_as_sf(data,
coords = c('Longitude','Latitude'),
crs = 'EPSG:4326')
data_sf=data_sf%>%
filter(!is.na(geometry))
shp=list.files(pattern = '.shp')
comm_boundary=st_read(shp)
comm_boundary=comm_boundary%>%
mutate(num_violent=sum(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'))))
st_crs(comm_boundary)
comm_boundary=st_read(shp,
crs='EPSG:4326')
comm_boundary=comm_boundary%>%
mutate(num_violent=sum(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'))))
comm_boundary=comm_boundary%>%
mutate(violent=sum(unlist(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))))
View(comm_boundary)
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
View(comm_boundary)
c
comm_boundary=comm_boundary%>%
mutate(violent=length(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'))))
View(comm_boundary)
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
View(comm_boundary)
comm_boundary=as.tibble(comm_boundary)%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
comm_boundary=tibble(comm_boundary)%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT')))
View(comm_boundary)
comm_boundary$violent
comm_boundary=tibble(comm_boundary)%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE))
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE))
comm_boundary=st_read(shp,
crs='EPSG:4326')
comm_boundary=comm_boundary%>%
mutate(violent=st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE))
View(comm_boundary)
comm_boundary=comm_boundary%>%
mutate(violent=sum(st_intersects(comm_boundary,filter(data_sf,Category=='VIOLENT'), sparse=FALSE)))
View(comm_boundary)
View(comm_boundary[[10]][[1]])
View(comm_boundary[[10]][[2]])
sum(st_intersects(comm_boundary,data_sf$geometry))
sum(st_intersects(comm_boundary,data_sf$geometry),sparse=FALSE)
library(png)
data_sf=st_as_sf(data_filtered,
coords = c('Longitude','Latitude'),
crs = 'EPSG:4326')
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
library(nngeo)
library(tibble)
library(factoextra)
library(png)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
knitr::opts_chunk$set(fig.align = 'center')
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
rename_with(.fn = function(x){str_to_title(x)})%>%
mutate(Day=wday(Date,label=TRUE)) %>%
mutate(Month=month(Date,label=TRUE))%>%
mutate(Hour=hour(Date))
ggplot(data = data, aes(x=Hour))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Hourly Crime Distribution')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()+
theme(plot.title = element_text(hjust = 0.5, size = 12))
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data_filtered=data%>%
mutate(Category=case_when(str_detect(Description,violent)~'Violent',
str_detect(Description,theft)~'Theft',
str_detect(Description,narcotic)~'Drug',
.default = 'Other' ))%>%
filter(str_detect(Category,'Violent|Theft|Drug'))
#hourly crime distribution by category of crime
data_filtered%>%
group_by(Category,Hour)%>%
ggplot(aes(x=Hour,fill=Category))+
labs(title='Hourly Crime Distribution')+
ylab('Frequency')+
stat_count()+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_grey()
library(stringr)
library(rmarkdown)
library(sf)
library(ggplot2)
library(dplyr)
library(stringi)
library(lubridate)
library(mapview)
library(leafpop)
library(spatstat)
library(dbscan)
library(RColorBrewer)
library(nngeo)
library(tibble)
library(factoextra)
library(png)
knitr::opts_chunk$set(echo=FALSE, include = FALSE, fig.width = 5, fig.height = 3,
fig.align = 'center')
data=read.csv('CrimesChicago20220225.csv')
data=data[,c('DATE..OF.OCCURRENCE','PRIMARY.DESCRIPTION','BEAT',
'WARD','LATITUDE','LONGITUDE')]
data=na.omit(data)
data$DATE..OF.OCCURRENCE=as.POSIXlt(data$DATE..OF.OCCURRENCE,
tz='America/Detroit',
tryFormats ='%m/%d/%Y %I:%M:%S %p')
data=data%>%
rename(DATE=DATE..OF.OCCURRENCE,DESCRIPTION=PRIMARY.DESCRIPTION)
data=data%>%
rename_with(.fn = function(x){str_to_title(x)})%>%
mutate(Day=wday(Date,label=TRUE)) %>%
mutate(Month=month(Date,label=TRUE))%>%
mutate(Hour=hour(Date))
ggplot(data = data, aes(x=Hour))+
stat_count(fill='lightblue',color='black')+
labs(title = 'Hourly Crime Distribution')+
ylab('Frequency')+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_gray()+
theme(plot.title = element_text(hjust = 0.5, size = 12))
#group according to crime "category"
violent=str_c(c('HOMICIDE','ASSAULT','BATTERY'), collapse = '|')
theft=str_c(c('MOTOR VEHICLE THEFT','ROBBERY','BURGLARY','THEFT'), collapse = '|')
narcotic=str_c(c('NARCOTICS','OTHER NARCOTIC VIOLATION'), collapse = '|')
data_filtered=data%>%
mutate(Category=case_when(str_detect(Description,violent)~'Violent',
str_detect(Description,theft)~'Theft',
str_detect(Description,narcotic)~'Drug',
.default = 'Other' ))%>%
filter(str_detect(Category,'Violent|Theft|Drug'))
#hourly crime distribution by category of crime
data_filtered%>%
group_by(Category,Hour)%>%
ggplot(aes(x=Hour,fill=Category))+
labs(title='Hourly Crime Distribution')+
ylab('Frequency')+
stat_count()+
scale_x_discrete(breaks=1:23, limits=as.character(1:23))+
theme_grey()+
theme(plot.title = element_text(hjust = 0.5, size = 12))
data_sf=st_as_sf(data_filtered,
coords = c('Longitude','Latitude'),
crs = 'EPSG:4326')
data_sf=data_sf%>%
filter(!is.na(geometry))
shp=list.files(pattern = '.shp')
comm_boundary=st_read(shp)
mapviewOptions(basemaps='OpenStreetMap', fgb = FALSE)
crime_map=mapview(data_sf,
zcol='Category',
col.regions=brewer.pal(3,'Dark2'),
legend=TRUE,
popup=popupTable(x=data_sf,
row.numbers=FALSE,
feature.id=FALSE),
layer.name='Crime Spatial Distribution')
#readPNG('mapshot.png', native=TRUE)
violent=data_filtered%>%
filter(Category=='Violent')%>%
select(Latitude,Longitude)
ggplot(violent,aes(y=Latitude,x=Longitude))+
geom_point()+
coord_sf(crs='EPSG:4326')+
theme_grey()+
theme(plot.title = element_text(hjust = 0.5, size = 12))
dbscan(violent,eps=0.1, minPts = 1000)%>%
fviz_cluster(data = violent, geom = 'point', main = 'Clustering of Violent Crimes', pointsize = 0.1)
violent%>%
scale()
dbscan(eps=0.1, minPts = 1000)%>%
fviz_cluster(data = violent, geom = 'point', main = 'Clustering of Violent Crimes', pointsize = 0.1)
violent%>%
scale()%>%
dbscan(eps=0.1, minPts = 1000)%>%
fviz_cluster(data = violent, geom = 'point', main = 'Clustering of Violent Crimes', pointsize = 0.1)
#daily crime distribution
knitr::opts_chunk$set(echo = TRUE)
ggplot(data = data, aes(x=Day))+
stat_count(fill='lightblue',color='black')+
labs(title='Daily Crime Distribution')+
xlab('Day')+
ylab('Frequency')+
scale_x_discrete()+
theme_gray()+
theme(plot.title = element_text(hjust = 0.5, size = 12))
#monthly crime distribution
ggplot(data = data, aes(x=Month))+
stat_count(fill='lightblue',color='black')+
labs(title='Monthly Crime Distribution')+
ylab('Frequency')+
scale_x_discrete()+
theme_gray()+
theme(plot.title = element_text(hjust = 0.5, size = 12))
#monthly crime distribution
ggplot(data = data, aes(x=Description))+
stat_count(fill='lightblue',color='black')+
labs(title='Crime Distribution by Category')+
ylab('Frequency')+
theme_grey()+
theme(axis.text.y = element_text(size = 7))+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 12))
violent%>%
dbscan(eps=0.1, minPts = 1000)%>%
fviz_cluster(data = violent, geom = 'point', main = 'Clustering of Violent Crimes', pointsize = 0.1)
violent%>%
dbscan(eps=1000, minPts = 10000)%>%
fviz_cluster(data = violent, geom = 'point', main = 'Clustering of Violent Crimes', pointsize = 0.1)
violent%>%
st_transform()
violent%>%
dbscan(eps=1.5/6371, minPts = 1000)%>%
fviz_cluster(data = violent, geom = 'point', main = 'Clustering of Violent Crimes', pointsize = 0.1)
View(violent)
gc()
gc()
